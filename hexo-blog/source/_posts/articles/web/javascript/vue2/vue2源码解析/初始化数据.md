---
title: 初始化数据
date: 2022-7-1 17:24:41
cover: false
tags:
  - Vue
  - 源码

---

# 初始化数据

响应式数据的核心？数据变化了，我可以监控到

监控的是什么呢？是数据的**取值**和**更改值**

监控到然后干嘛呢？更新视图

满足上面要求的数据，就是响应式数据。简单点来说，响应式数据变化可以更新视图



不考虑工程化开发，当初在`html`中我们是这么写`Vue`代码的

把所有需要的数据，都放在配置对象里

```html
<script src='vue.js'></script>
<script>
	const vm = new Vue({
        data: {
            name: 'sai',
            age: 18
        }
    })
</script>
```



> Tips：`Vue2`中没有用类的写法，因为类的方法如果有很多，就都耦合在一起了，函数的写法直接`Vue.prototype`就可以了（虽然类也可以Vue.prototype这样写，但一般不会这样搞）
>
> ```js
> function Vue() {
> 
> }
> 
> Vue.prototype.a = function(){}
> Vue.prototype.b = function(){}
> Vue.prototype.c = function(){}
> 
> export default Vue
> ```
>
> 并且可以将扩展的功能单独放在一个文件中，方便管理



那么现在要干嘛呢？

模拟实现`Vue`的功能

`index.js`

`options`就是用户传入的选项，拿到`options`后，肯定要处理下的

我们给原型对象上添加个`_init`方法，专门用来做初始化

```js
function Vue(options) { // options就是用户的选项
    // 拿到用户的options，做一下初始化
    this._init(options)
}

// 用于初始化操作
Vue.prototype._init = function(options) {

}

export default Vue
```

但是不能都写在`index.js`里，不然代码一多就完犊子了

新建`src/init.js`

```js
// 用于初始化操作
Vue.prototype._init = function(options) {

}
```

问题来了，这个时候`Vue`就丢失了，咋整？

可以把初始化操作，封装成函数并导出，这个函数接收一个形参

`init.js`

```js
// 就是给Vue增加_init方法的
export function initMixin(Vue) {
    // 用于初始化操作
    Vue.prototype._init = function(options) {

    }
}
```

在`index.js`就可以传入实参`Vue`使用了

```js
function Vue(options) { // options就是用户的选项
    // 拿到用户的options，做一下初始化
    this._init(options)
}

// 给Vue增加init方法
initMixin(Vue) // 扩展了init方法

export default Vue
```

`initMixin`相当于扩展了`_init`方法，后续再有逻辑，可以再`initXXX(xxx)`，就可以原型方法，扩展成一个个函数，通过函数的形式在原型上扩展功能

靠谱！！！













